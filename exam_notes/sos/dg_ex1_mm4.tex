\chapter{Differential Games Exercise 1 mm4}

\assignment{
  Consider the nonzero-sum, 2-player differential game:
  \begin{equation}
    \label{eq:dg_cost}
    \max_{u_i\in \mathbb{R}} J_i = -\frac{1}{2} x(T)^2 - \frac{1}{2}\int_0^T r_i\left( u_1^2 + u_2^2 \right)\,\up{dt},
    \quad i = 1,2
  \end{equation}
  subject to:
  \begin{equation}
    \label{eq:dg_constraint}
    \dot{x} = ax + b_1u_1 + b_2u_2, \quad x(0) = x_0
  \end{equation}
  where $x(T), x_0, a, b_i \in \mathbb{R}$ and $r_i, T > 0$ for $i = 1, 2$ are given constants.
  \begin{enumerate}
  \item Write-up the Hamiltonian $H^i , i = 1, 2$, for the $i$th player.
  \item Find the$^1$ (open-loop) Nash solution $\{ \bar{u}_1, \bar{u}_2 \}$ for \eqref{eq:dg_cost} and
    \eqref{eq:dg_constraint} (the $\bar{u}_i$’s will depend on the adjoint variables).
  \item Write-up the adjoint equation’s.
  \item Solve the adjoint equation’s and use the obtained solutions to write-up the Nash solutions, found in exercise
    (1b), as functions of time.
  \item (Extra) Use the expression for $\bar{u}_i$, $i = 1, 2$, to solve \eqref{eq:dg_constraint}.
  \end{enumerate}
  \vspace{0.5cm}
  \footnotesize{$^1$In the course you where only given necessary conditions for the existence of a Nash solution. However, for this
  particular problem these conditions are also sufficient.}
}

\assignment{1. Write-up the Hamiltonian $H^i , i = 1, 2$, for the $i$th player.
}
The Hamiltonian is given as:
\begin{equation}
        H^{i} = F^{i} + \lambda^{i}f
\end{equation}
\begin{equation}
        H^{i} = -\frac{1}{2} r^{i}\left(u^2_{i} + u^2_{i+1}\right) + \lambda^{i} \left(ax + b^{i}u^{i} + b^{i+1}u^{i+1}\right)
\end{equation}

\assignment{
        2. Find the$^1$ (open-loop) Nash solution $\{ \bar{u}_1, \bar{u}_2 \}$ for \eqref{eq:dg_cost} and
    \eqref{eq:dg_constraint} (the $\bar{u}_i$’s will depend on the adjoint variables).
}
The open-loop Nash solution is found by maximising the control signal $\{\bar{u}^{1},\bar{u}^{2}\}$ and found by:
\begin{equation}
        \begin{split}
                &H^i_{u^i} = - r^i u^i + \lambda^i b^i = 0\\
                &\Downarrow\\
                &\bar{u}^{\,i} = \frac{b^i \lambda^i}{r^i}
        \end{split}
\end{equation}

\assignment{
        3. Write-up the adjoint equation’s.
}
The adjoint equations for the Nash solution
\begin{equation}
        \dot{\lambda}^i = -H^i_{x} \quad \Rightarrow \quad \dot{\lambda}^i = -a \lambda^i
\end{equation}
\begin{equation}
        \lambda^i(T) = S_{x}^i \left[x(T)\right]  = -x(T)
\end{equation}

\assignment{
        4. Solve the adjoint equation’s and use the obtained solutions to write-up the Nash solutions, found in exercise
    (1b), as functions of time.
}
The solution the the adjoint differential equation can be found by the use of exponential functions.
\begin{equation}
        \dot{\lambda}^i = -a \lambda^i \quad \Rightarrow \quad \lambda^i(t) = e^{-a t}C
\end{equation}
where $C$ determines the terminating state and is given as
\begin{equation}
        C = -x(T) e^{aT}
\end{equation}
Then the complete solution becomes
\begin{equation}
        \lambda^i(t) = -x(T) e^{-a t} e^{aT} = -x(T)e^{a(T-t)}
\end{equation}

the optimal time dependent control $\bar{u}^i(t)$ is then given as
\begin{equation}
        \bar{u}^i(t) = \frac{-b^i x(t)}{r^i} e^{a(T-t)}
\end{equation}